이상적으로 인터넷 서비스가 데이터의 손실 없이 두 종단 시스템 간에 원하는 만큼의 데이터를 이동시키기를 희망하지만, 필연적으로 지연이 생기거나 혹은 패킷을 잃어버리기도 한다.
해당 절에서는 네트워크 상에서의 지연, 손실 그리고 처리량을 알아보자.

### 1.4.1 패킷 교환 네트워크에서의 지연 개요
위에서 두 종단 시스템간에 데이터를 주고 받을 때에는 필연적으로 지연이나 패킷 손실이 발생한다고 말했는데, 그 이유에 대해 먼저 살펴보자.
그러기 위해선 패킷이 출발지 호스트에서 출발하여 목적지 호스트까지 가는 여정을 먼저 살펴봐야겠다.
출발지 호스트에서 출발한 패킷이 일련의 라우터들을 통과하여 목적지 호스트와 가까운 라우터들로 이동하게 되는데 그 **라우터**들을 거치는 과정에서 "지연"이 발생하게 된다.

그 지연 중에는
- 노드 처리 지연
- 큐잉 지연
- 전송 지연
- 전파지연

이 있고 얘네들이 모여서 전체 노드 지연이 일어나게 된다.

<p align="center">
  <img src="image1.png" alt="인터넷 이미지" width="500"/> 
</p>

가장 간단하게 패킷이 라우터를 거쳐 목적지로 이동하는 과정을 살펴보자.
패킷이 라우터 A 에 도착하게 되면 라우터 A 는 패킷의 해더를 조사하여 어디로 패킷을 전송할지 결정하고 거기로 전송해주는 역할을 하는데,
여기서 패킷헤더를 조사할 때 걸리는 지연을 **처리지연** 이라고 한다.

즉, 한마디로 라우터가 헤더를 조사하고 그 패킷을 어디로 보낼지 결정하는 시간이다.

위에서 본 과정은 이미 처리중인 패킷이 없을 때, 라우터의 큐가 비어있을 때에서의 동작과정이었는데, 만약 하나의 라우터에 2개 이상의 패킷이 왔을 때를 생각해보자.

라우터는 한번에 하나의 패킷만을 처리할 수 있기 때문에 큐라고 하는 곳에서 패킷들이 대기하게 된다. 이 지연을 **큐잉지연** 이라고 한다.

즉, 한마디로 대기 중인 큐에서 링크로 전송되기를 기다릴 때 걸리는 시간이다.

이제 패킷을 전송할 준비가 끝났다면 실제로 목적지를 향해 패킷을 밀어내야하는데 그 성능은 링크의 전송률에 달려있다.
예를 들어 200Mbps 이더넷 링크의 경우 전송률 R 은 200Mbps이다. 전송률이란 패킷을 담아 보낼 수 있는 크기라고 생각하면 되는데
나는 200Mbps 만 처리할 수 있는데 1000Mbps 의 패킷을 전송해야한다면 200Mbps 씩 5번 정송해야하므로 여기서 발생하는 **전송지연** 은
L/R (R: 전송률, L: 패킷의 길이) 라고 할 수 있다.

전송지연이라는 것의 이해를 돕기 위해 예시를 들어보자면 총 10명의 승객이 타야 출발하는 버스가 있고, 한명씩 탑승할 수 있으며 승객 1명이 탑승하는데 1초의 시간이 걸린다고 생각해보자. 모든 승객이 탑승하는데 걸리는 시간은 10초. 그러면 10초가 지연된다.

2명씩 탑승할 수 있고, 승객이 탑승할 때 1초가 걸린다면 이번엔 5초 지연이 발생한다.
여기서 지연의 기준은 다른 버스에 새로운 무리의 승객이 탑승하려면 이전 무리의 승객들이 모두 떠나야 탑승을 시작할 수 있다는 가정에서의 지연을 의미한다.

여기까지 오게되면 이제 모든 패킷들이 라우터에서 벗어나 링크에 전해지게 된다.

이제 링크를 타고 패킷들이 이동하면서 생기는 지연을 **전파지연** 이라고 한다. 앞선 예시를 이어서 말해보자면 승객을 모두 태운 버스로 이동하는데 걸리는 시간이라고 할 수 있겠다.
전파 속도는 링크의 물리 매체(광섬유, 꼬임쌍선 등)에 따라 달라지게 되는데, 전파지연은 두 라우터 사이의 거리를 전파속도로 나눈 것이다.
즉, 전파지연은 d/s 이다. d는 라우터 사이의 거리이고 s 는 링크의 전파속도를 의미한다.

위에서 전송지연은 버스에 승객들이 전부 탑승할 때 까지의 시간, 전파지연은 버스로 이동하는데 걸리는 시간이라고 비유했는데 다시 한번 비교를 해보자.
전송지연은 라우터가 패킷을 '내보내는 데' 필요한 시간이다. 두 라우터 사이의 거리와는 관계가 없으며 단순히 출발지 라우터가 패킷을 내보는데 필요한 시간이다.
반면에 전파지연은 비트가 한 라우터에서 다음 라우터로 '전파'되는데 걸리는 시간이다. 두 라우터 사이의 거리에 대한 함수이며 패킷 길이나 링크 전송률과는 무관하다.

이번엔 요금 계산소가 있는 고속도로 예시를 들어 생각해보자. 총 10대의 자동차 대열이 함께 여행을 한다고 가정하고, 100km 마다 요금 계산소가 있으며 차가 시속 100km 로 고속도로를 달리고, 각 요금 계산소는 12초마다 한 대의 차를 서비스한다고 가정해보자.
10대의 자동차는 함께 여행을 하기 때문에 모든 차가 요금 계산소에 도착할 때까지 이전에 도착한 차들은 기다리기로 했다. 전체 차량이 다음 요금 계산소로 전송되기 전에 요금 계산소에 저장된다고 볼 수 있겠다.
모든 자동차가 도착하고 요금 계산소가 전체 차량을 서비스하는데 걸리는 시간은 총 10대, 각 12초이므로 10*12초 = 120초 (2분) 이 걸리게 된다. 이 시간은 라우터에서의 **전송지연**과 유사하다.
요금 계산소를 통과한 자동차가 다음 요금 계산소로 이동하는데에는 1시간이 걸리게 되고 이렇게 이동하는 시간은 **전파 지연**과 유사하다.

조금 더 네트워크에서 일어날 법한 예제를 살펴보자.
만약 자동차의 시속이 1000km 이고 요금 계산소는 1분에 1대를 서비스한다고 해보자. 그러면 요금 계산소 사이의 거리는 100km 이니까 

1000km : 1hr = 100km : x hr
여기서 x = 1/10 (6분)
따라서 요금 계산 소 사이의 이동지연은 6분이 되고 차량들을 서비스하는데 걸리는 시간은 10분이 된다.
이 경우에 처음 몇 자동차는 마지막 자동차가 첫번째 요금 계산소를 벗어나기 전에 두 번째 요금 계산소에 먼저 도착하게 되고 그렇게 되면 다음 자동차가 도착하기를 기다리는 시간들이 다시금 발생하게 된다.
유사한 경우가 패킷 교환 네트워크에서도 발생할 수 있다. 패킷의 앞선 비트들이 나머지 비트가 이전 라우터에서 전송되기를 기다리는 동안에 이미 다음 라우터에 도착할 수 있는 것이다.
그래서 위에서 살펴본 노드지연, 전송지연, 전파지연, 큐잉지연이 모두 합해진 값이 전체 노드 지연을 의미할 수 있게된다.


### 1.4.2 큐잉 지연과 패킷 손실



### 1.4.3 종단간 지연


### 1.4.4 컴퓨터 네트워크에서의 처리율

